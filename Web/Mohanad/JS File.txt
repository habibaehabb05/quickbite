document.addEventListener('DOMContentLoaded', function() {
    // Cart functionality
    let cart = [];
    const cartCount = document.querySelector('.cart-count');
    const cartItemsContainer = document.querySelector('.cart-items');
    const totalPriceElement = document.querySelector('.total-price');
    const clearCartBtn = document.querySelector('.clear-cart-btn');
    
    // Add to cart buttons
    const addToCartButtons = document.querySelectorAll('.add-to-cart');
    
    addToCartButtons.forEach(button => {
        button.addEventListener('click', function() {
            const mealBox = this.closest('.meal-box');
            const item = {
                name: this.getAttribute('data-name'),
                price: parseFloat(this.getAttribute('data-price')),
                description: mealBox.querySelector('p').textContent,
                id: Date.now() // Unique ID for each item
            };
            
            cart.push(item);
            updateCart();
            
            // Show added notification
            showNotification(`${item.name} added to cart!`);
        });
    });
    
    // Clear cart button functionality
    clearCartBtn.addEventListener('click', function() {
        if (cart.length === 0) {
            showNotification('Cart is already empty');
            return;
        }
        
        cart = [];
        updateCart();
        showNotification('Cart cleared successfully');
    });
    
    function updateCart() {
        // Update cart count
        cartCount.textContent = cart.length;
        cartCount.style.display = cart.length ? 'flex' : 'none';
        
        // Update cart items
        cartItemsContainer.innerHTML = '';
        
        let total = 0;
        
        cart.forEach(item => {
            total += item.price;
            
            const cartItemElement = document.createElement('div');
            cartItemElement.className = 'cart-item';
            cartItemElement.innerHTML = `
                <div class="cart-item-info">
                    <h4 class="cart-item-name">${item.name}</h4>
                    <p class="cart-item-desc">${item.description}</p>
                    <p class="cart-item-price">${item.price} EGP</p>
                </div>
                <button class="cart-item-remove" data-id="${item.id}">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            
            cartItemsContainer.appendChild(cartItemElement);
            
            // Add event listener to remove button
            const removeBtn = cartItemElement.querySelector('.cart-item-remove');
            removeBtn.addEventListener('click', function() {
                const itemId = parseInt(this.getAttribute('data-id'));
                removeFromCart(itemId);
            });
        });
        
        // Update total price
        totalPriceElement.textContent = `${total.toFixed(2)} EGP`;
    }
    
    function removeFromCart(itemId) {
        cart = cart.filter(item => item.id !== itemId);
        updateCart();
        showNotification('Item removed from cart');
    }
    
    function showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.innerHTML = `
            <i class="fas fa-check-circle"></i>
            <span>${message}</span>
        `;
        document.body.appendChild(notification);
        
        // Show notification
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);
        
        // Hide after 3 seconds
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }
    
    // Initialize cart
    updateCart();
});